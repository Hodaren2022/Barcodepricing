🤖 協作流程：執行前的差異確認政策

🎯 政策目標

為了確保程式碼變更的安全性、準確性與可控性，我們正式啟用「執行前的差異確認」機制。本政策的目標是將程式碼修改納入您 (使用者/開發者) 的高階工作流程（深度理解、頻繁驗證、嚴謹修正）中，確保所有變更都經過嚴格審核。

⚙️ 核心原則：無授權不變更

在未經使用者明確批准的情況下，我（Gemini）絕不會執行任何程式碼檔案的寫入或替換操作。

🛠️ 差異確認流程 (Diff Confirmation Workflow)

當我分析任務並得出需要修改現有程式碼的結論時，我將遵循以下嚴格的步驟：

步驟 1：提出變更請求（由 Gemini 執行）

我將以清晰的格式展示所有計劃中的變更。

變更位置識別：

明確指出要修改的檔案路徑（{filepath}）。

明確指出變更發生在檔案中的哪個函數或組件中（例如：App 組件中的 useEffect 鉤子）。

差異展示：

提供一個標註了行號的程式碼區塊，其中包含完整的舊程式碼片段（即將被移除的內容）。

提供一個標註了行號的程式碼區塊，其中包含完整的新程式碼片段（計劃替換進去的內容）。

等待確認：

在請求的最後，我會明確請求您的輸入，確認是否繼續執行變更。

步驟 2：使用者響應（由您執行）

作為使用者，您的回覆將決定下一步的動作。您有三個可接受的回應類型：

回應

效果

範例指令

批准 (Accept)

允許我立即執行所有提出的變更。

批准 / 同意 / 可以

拒絕 (Reject)

取消本次變更，我將保留現有程式碼，並重新評估我的解決方案。

拒絕 / 不要動

要求修正 (Modify)

允許我針對提出的差異進行迭代修改，然後重新進入「步驟 1」。

新程式碼中，請將變數名稱從 X 改為 Y。

🔗 與通用工作流程的連結

此政策直接支持您先前規定的通用工作流程：

深度理解與反思： 準備差異報告的過程，迫使我必須在執行前對變更的邏輯和影響進行最終的反思。

增量實施與頻繁驗證： 變更報告本身就是一個微小的、可驗證的步驟，允許您在程式碼被寫入前進行驗證。

修正與除錯： 透過差異確認，我們可以共同在變更部署到實際程式碼之前捕捉潛在的錯誤或邏輯缺陷。

本文件為我們協作的最高安全協議，我們將嚴格遵守。